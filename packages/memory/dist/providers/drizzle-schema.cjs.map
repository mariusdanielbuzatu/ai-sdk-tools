{"version":3,"sources":["../../src/providers/drizzle-schema.ts"],"sourcesContent":["/**\r\n * Schema helpers for Drizzle provider\r\n *\r\n * These helpers make it easy to create compatible table schemas\r\n * for any database backend (PostgreSQL, MySQL, SQLite).\r\n *\r\n * Note: These functions use `any` types because they accept Drizzle's\r\n * table builder objects which have different types for each database.\r\n * This is intentional to support all database backends.\r\n */\r\n\r\n// PostgreSQL Schema Helpers\r\n/**\r\n * Create a working memory table schema for PostgreSQL\r\n *\r\n * @example\r\n * ```ts\r\n * import { pgTable } from 'drizzle-orm/pg-core';\r\n * import { createPgWorkingMemorySchema } from '@ai-sdk-tools/memory/drizzle';\r\n *\r\n * export const workingMemory = pgTable('working_memory', createPgWorkingMemorySchema());\r\n * ```\r\n */\r\nexport function createPgWorkingMemorySchema() {\r\n  // Import types will be resolved at runtime by user\r\n  // This returns the schema object that works with pgTable\r\n  return {\r\n    id: (t: any) => t.text(\"id\").primaryKey(),\r\n    scope: (t: any) => t.text(\"scope\").notNull(),\r\n    chatId: (t: any) => t.text(\"chat_id\"),\r\n    userId: (t: any) => t.text(\"user_id\"),\r\n    content: (t: any) => t.text(\"content\").notNull(),\r\n    updatedAt: (t: any) => t.timestamp(\"updated_at\").notNull(),\r\n  };\r\n}\r\n\r\n/**\r\n * Create a conversation messages table schema for PostgreSQL\r\n *\r\n * @example\r\n * ```ts\r\n * import { pgTable, serial } from 'drizzle-orm/pg-core';\r\n * import { createPgMessagesSchema } from '@ai-sdk-tools/memory/drizzle';\r\n *\r\n * export const messages = pgTable('conversation_messages', createPgMessagesSchema());\r\n * ```\r\n */\r\nexport function createPgMessagesSchema() {\r\n  return {\r\n    id: (t: any) => t.serial(\"id\").primaryKey(),\r\n    chatId: (t: any) => t.text(\"chat_id\").notNull(),\r\n    userId: (t: any) => t.text(\"user_id\"),\r\n    role: (t: any) => t.text(\"role\").notNull(),\r\n    content: (t: any) => t.text(\"content\").notNull(),\r\n    timestamp: (t: any) => t.timestamp(\"timestamp\").notNull(),\r\n  };\r\n}\r\n\r\n// MySQL Schema Helpers\r\n/**\r\n * Create a working memory table schema for MySQL\r\n *\r\n * @example\r\n * ```ts\r\n * import { mysqlTable } from 'drizzle-orm/mysql-core';\r\n * import { createMysqlWorkingMemorySchema } from '@ai-sdk-tools/memory/drizzle';\r\n *\r\n * export const workingMemory = mysqlTable('working_memory', createMysqlWorkingMemorySchema());\r\n * ```\r\n */\r\nexport function createMysqlWorkingMemorySchema() {\r\n  return {\r\n    id: (t: any) => t.varchar(\"id\", { length: 255 }).primaryKey(),\r\n    scope: (t: any) => t.varchar(\"scope\", { length: 50 }).notNull(),\r\n    chatId: (t: any) => t.varchar(\"chat_id\", { length: 255 }),\r\n    userId: (t: any) => t.varchar(\"user_id\", { length: 255 }),\r\n    content: (t: any) => t.text(\"content\").notNull(),\r\n    updatedAt: (t: any) => t.timestamp(\"updated_at\").notNull(),\r\n  };\r\n}\r\n\r\n/**\r\n * Create a conversation messages table schema for MySQL\r\n */\r\nexport function createMysqlMessagesSchema() {\r\n  return {\r\n    id: (t: any) => t.int(\"id\").primaryKey().autoincrement(),\r\n    chatId: (t: any) => t.varchar(\"chat_id\", { length: 255 }).notNull(),\r\n    userId: (t: any) => t.varchar(\"user_id\", { length: 255 }),\r\n    role: (t: any) => t.varchar(\"role\", { length: 50 }).notNull(),\r\n    content: (t: any) => t.text(\"content\").notNull(),\r\n    timestamp: (t: any) => t.timestamp(\"timestamp\").notNull(),\r\n  };\r\n}\r\n\r\n// SQLite Schema Helpers\r\n/**\r\n * Create a working memory table schema for SQLite\r\n *\r\n * @example\r\n * ```ts\r\n * import { sqliteTable } from 'drizzle-orm/sqlite-core';\r\n * import { createSqliteWorkingMemorySchema } from '@ai-sdk-tools/memory/drizzle';\r\n *\r\n * export const workingMemory = sqliteTable('working_memory', createSqliteWorkingMemorySchema());\r\n * ```\r\n */\r\nexport function createSqliteWorkingMemorySchema() {\r\n  return {\r\n    id: (t: any) => t.text(\"id\").primaryKey(),\r\n    scope: (t: any) => t.text(\"scope\").notNull(),\r\n    chatId: (t: any) => t.text(\"chat_id\"),\r\n    userId: (t: any) => t.text(\"user_id\"),\r\n    content: (t: any) => t.text(\"content\").notNull(),\r\n    updatedAt: (t: any) =>\r\n      t.integer(\"updated_at\", { mode: \"timestamp\" }).notNull(),\r\n  };\r\n}\r\n\r\n/**\r\n * Create a conversation messages table schema for SQLite\r\n */\r\nexport function createSqliteMessagesSchema() {\r\n  return {\r\n    id: (t: any) => t.integer(\"id\").primaryKey({ autoIncrement: true }),\r\n    chatId: (t: any) => t.text(\"chat_id\").notNull(),\r\n    userId: (t: any) => t.text(\"user_id\"),\r\n    role: (t: any) => t.text(\"role\").notNull(),\r\n    content: (t: any) => t.text(\"content\").notNull(),\r\n    timestamp: (t: any) =>\r\n      t.integer(\"timestamp\", { mode: \"timestamp\" }).notNull(),\r\n  };\r\n}\r\n\r\n// Chat Sessions Schema Helpers\r\n\r\n/**\r\n * Create a chat sessions table schema for PostgreSQL\r\n *\r\n * @example\r\n * ```ts\r\n * import { pgTable } from 'drizzle-orm/pg-core';\r\n * import { createPgChatsSchema } from '@ai-sdk-tools/memory/drizzle';\r\n *\r\n * export const chats = pgTable('chat_sessions', createPgChatsSchema());\r\n * ```\r\n */\r\nexport function createPgChatsSchema() {\r\n  return {\r\n    chatId: (t: any) => t.text(\"chat_id\").primaryKey(),\r\n    userId: (t: any) => t.text(\"user_id\"),\r\n    title: (t: any) => t.text(\"title\"),\r\n    createdAt: (t: any) => t.timestamp(\"created_at\").notNull(),\r\n    updatedAt: (t: any) => t.timestamp(\"updated_at\").notNull(),\r\n    messageCount: (t: any) => t.integer(\"message_count\").notNull().default(0),\r\n  };\r\n}\r\n\r\n/**\r\n * Create a chat sessions table schema for MySQL\r\n *\r\n * @example\r\n * ```ts\r\n * import { mysqlTable } from 'drizzle-orm/mysql-core';\r\n * import { createMysqlChatsSchema } from '@ai-sdk-tools/memory/drizzle';\r\n *\r\n * export const chats = mysqlTable('chat_sessions', createMysqlChatsSchema());\r\n * ```\r\n */\r\nexport function createMysqlChatsSchema() {\r\n  return {\r\n    chatId: (t: any) => t.varchar(\"chat_id\", { length: 255 }).primaryKey(),\r\n    userId: (t: any) => t.varchar(\"user_id\", { length: 255 }),\r\n    title: (t: any) => t.varchar(\"title\", { length: 500 }),\r\n    createdAt: (t: any) => t.timestamp(\"created_at\").notNull(),\r\n    updatedAt: (t: any) => t.timestamp(\"updated_at\").notNull(),\r\n    messageCount: (t: any) => t.int(\"message_count\").notNull().default(0),\r\n  };\r\n}\r\n\r\n/**\r\n * Create a chat sessions table schema for SQLite\r\n *\r\n * @example\r\n * ```ts\r\n * import { sqliteTable } from 'drizzle-orm/sqlite-core';\r\n * import { createSqliteChatsSchema } from '@ai-sdk-tools/memory/drizzle';\r\n *\r\n * export const chats = sqliteTable('chat_sessions', createSqliteChatsSchema());\r\n * ```\r\n */\r\nexport function createSqliteChatsSchema() {\r\n  return {\r\n    chatId: (t: any) => t.text(\"chat_id\").primaryKey(),\r\n    userId: (t: any) => t.text(\"user_id\"),\r\n    title: (t: any) => t.text(\"title\"),\r\n    createdAt: (t: any) =>\r\n      t.integer(\"created_at\", { mode: \"timestamp\" }).notNull(),\r\n    updatedAt: (t: any) =>\r\n      t.integer(\"updated_at\", { mode: \"timestamp\" }).notNull(),\r\n    messageCount: (t: any) => t.integer(\"message_count\").notNull().default(0),\r\n  };\r\n}\r\n\r\n/**\r\n * Example SQL for manual schema creation\r\n */\r\nexport const SQL_SCHEMAS = {\r\n  postgresql: {\r\n    workingMemory: `\r\n      CREATE TABLE IF NOT EXISTS working_memory (\r\n        id TEXT PRIMARY KEY,\r\n        scope TEXT NOT NULL,\r\n        chat_id TEXT,\r\n        user_id TEXT,\r\n        content TEXT NOT NULL,\r\n        updated_at TIMESTAMP NOT NULL DEFAULT NOW()\r\n      );\r\n      CREATE INDEX IF NOT EXISTS idx_working_memory_scope ON working_memory(scope, chat_id, user_id);\r\n    `,\r\n    messages: `\r\n      CREATE TABLE IF NOT EXISTS conversation_messages (\r\n        id SERIAL PRIMARY KEY,\r\n        chat_id TEXT NOT NULL,\r\n        user_id TEXT,\r\n        role TEXT NOT NULL,\r\n        content TEXT NOT NULL,\r\n        timestamp TIMESTAMP NOT NULL DEFAULT NOW()\r\n      );\r\n      CREATE INDEX IF NOT EXISTS idx_messages_chat ON conversation_messages(chat_id, timestamp DESC);\r\n    `,\r\n    chats: `\r\n      CREATE TABLE IF NOT EXISTS chat_sessions (\r\n        chat_id TEXT PRIMARY KEY,\r\n        user_id TEXT,\r\n        title TEXT,\r\n        created_at TIMESTAMP NOT NULL DEFAULT NOW(),\r\n        updated_at TIMESTAMP NOT NULL DEFAULT NOW(),\r\n        message_count INTEGER NOT NULL DEFAULT 0\r\n      );\r\n      CREATE INDEX IF NOT EXISTS idx_chats_user ON chat_sessions(user_id, updated_at DESC);\r\n    `,\r\n  },\r\n  mysql: {\r\n    workingMemory: `\r\n      CREATE TABLE IF NOT EXISTS working_memory (\r\n        id VARCHAR(255) PRIMARY KEY,\r\n        scope VARCHAR(50) NOT NULL,\r\n        chat_id VARCHAR(255),\r\n        user_id VARCHAR(255),\r\n        content TEXT NOT NULL,\r\n        updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\r\n      );\r\n      CREATE INDEX idx_working_memory_scope ON working_memory(scope, chat_id, user_id);\r\n    `,\r\n    messages: `\r\n      CREATE TABLE IF NOT EXISTS conversation_messages (\r\n        id INT PRIMARY KEY AUTO_INCREMENT,\r\n        chat_id VARCHAR(255) NOT NULL,\r\n        user_id VARCHAR(255),\r\n        role VARCHAR(50) NOT NULL,\r\n        content TEXT NOT NULL,\r\n        timestamp TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\r\n      );\r\n      CREATE INDEX idx_messages_chat ON conversation_messages(chat_id, timestamp DESC);\r\n    `,\r\n    chats: `\r\n      CREATE TABLE IF NOT EXISTS chat_sessions (\r\n        chat_id VARCHAR(255) PRIMARY KEY,\r\n        user_id VARCHAR(255),\r\n        title VARCHAR(500),\r\n        created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\r\n        updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\r\n        message_count INT NOT NULL DEFAULT 0\r\n      );\r\n      CREATE INDEX idx_chats_user ON chat_sessions(user_id, updated_at DESC);\r\n    `,\r\n  },\r\n  sqlite: {\r\n    workingMemory: `\r\n      CREATE TABLE IF NOT EXISTS working_memory (\r\n        id TEXT PRIMARY KEY,\r\n        scope TEXT NOT NULL,\r\n        chat_id TEXT,\r\n        user_id TEXT,\r\n        content TEXT NOT NULL,\r\n        updated_at INTEGER NOT NULL\r\n      );\r\n      CREATE INDEX IF NOT EXISTS idx_working_memory_scope ON working_memory(scope, chat_id, user_id);\r\n    `,\r\n    messages: `\r\n      CREATE TABLE IF NOT EXISTS conversation_messages (\r\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n        chat_id TEXT NOT NULL,\r\n        user_id TEXT,\r\n        role TEXT NOT NULL,\r\n        content TEXT NOT NULL,\r\n        timestamp INTEGER NOT NULL\r\n      );\r\n      CREATE INDEX IF NOT EXISTS idx_messages_chat ON conversation_messages(chat_id, timestamp DESC);\r\n    `,\r\n    chats: `\r\n      CREATE TABLE IF NOT EXISTS chat_sessions (\r\n        chat_id TEXT PRIMARY KEY,\r\n        user_id TEXT,\r\n        title TEXT,\r\n        created_at INTEGER NOT NULL,\r\n        updated_at INTEGER NOT NULL,\r\n        message_count INTEGER NOT NULL DEFAULT 0\r\n      );\r\n      CREATE INDEX IF NOT EXISTS idx_chats_user ON chat_sessions(user_id, updated_at DESC);\r\n    `,\r\n  },\r\n} as const;\r\n"],"mappings":"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","names":[]}